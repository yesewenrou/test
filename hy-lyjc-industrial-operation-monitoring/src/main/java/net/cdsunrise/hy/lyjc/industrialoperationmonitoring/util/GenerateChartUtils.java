package net.cdsunrise.hy.lyjc.industrialoperationmonitoring.util;

import cn.hutool.core.codec.Base64;
import cn.hutool.core.collection.CollectionUtil;
import cn.hutool.core.io.FileUtil;
import com.fasterxml.jackson.core.type.TypeReference;
import lombok.extern.slf4j.Slf4j;
import net.cdsunrise.common.utility.utils.JsonUtils;
import net.cdsunrise.common.utility.vo.Result;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.entity.vo.ScenicReportVO;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.entity.vo.StringLongVO;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.vo.KeyAndValue;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.vo.SpecialReportWordData;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.vo.TourismConsumptionIndustryAnalyzeVO;
import net.cdsunrise.hy.lyjc.industrialoperationmonitoring.vo.TourismConsumptionSourceAnalyzeVO;

import java.io.*;
import java.math.BigDecimal;
import java.util.*;
import java.util.stream.Collectors;

/**
 * 生成Echarts图片工具类
 * @author zbk
 * @date 2020/4/29 10:18
 */
@Slf4j
@SuppressWarnings("all")
public class GenerateChartUtils {
    private static final String TEMP_DIR = "D:\\temp";
/*
    public static String PIC1 = "{title:[{text:'{name|'+'县域客流量'+'}\\n{val|'+12333+'}',top:'center',left:'center',textStyle:{rich:{name:{fontSize:24,fontWeight:'normal',color:'#666666',padding:[10,0]},val:{fontSize:32,fontWeight:'bold',color:'#333333',}}}}],\"legend\":{bottom:55,\"orient\":\"vertical\",\"bottom\":\"center\",\"icon\":\"circle\",\"left\":\"75%\",\"data\":[\"省内\",\"省外\",\"境外\"],\"itemGap\":25,\"selectedMode\":false,\"textStyle\":{\"color\":\"#607A8D\",\"rich\":{\"a\":{},\"b\":{\"align\":\"right\"},\"c\":{\"align\":\"right\"}}}},series:[{type:'pie',center:['50%','50%'],radius:['60%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#40A9FF\",\"#F2B50E\",\"#F655AA\",\"#9254DE\",\"#597EF7\",\"#13C2C2\",\"#6CBA52\",\"#097C25\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},data:[{name:\"省内\",value:4848935},{name:\"省外\",value:771435},{name:\"境外\",value:3390}],}]}";
    public static String PIC2 = "{\"color\":[\"#1FA8F8\"],\"title\":{\"show\":false,\"link\":\"\",\"target\":\"self\",\"text\":\"\",\"x\":\"left\",\"padding\":[25,0,0,5],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"}},\"grid\":{\"top\":15,\"left\":10,\"right\":\"6%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"value\",\"boundaryGap\":[0,0],\"data\":[],\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}},\"show\":true,\"position\":\"bottom\"}],\"yAxis\":[{\"type\":\"category\",\"data\":[\"自贡市\",\"凉山彝族自治州\",\"宜宾市\",\"内江市\",\"德阳市\",\"绵阳市\",\"雅安市\",\"乐山市\",\"成都市\",\"眉山市\"],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"},\"show\":false},\"axisTick\":[{\"show\":false}],\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":\"14\",\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"bar\",\"barMaxWidth\":20,\"barWidth\":12,\"data\":[24942,27375,27502,27987,40481,46735,103180,611738,1088026,2739900],\"itemStyle\":{\"normal\":{\"label\":{\"show\":false,\"position\":\"inside\"}}}}]}";
    public static String PIC3 = "{\"color\":[\"#1FA8F8\"],\"title\":{\"show\":false,\"link\":\"\",\"target\":\"self\",\"text\":\"\",\"x\":\"left\",\"padding\":[25,0,0,5],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"}},\"grid\":{\"top\":15,\"left\":10,\"right\":\"6%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"value\",\"boundaryGap\":[0,0],\"data\":[],\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}},\"show\":true,\"position\":\"bottom\"}],\"yAxis\":[{\"type\":\"category\",\"data\":[\"自贡市\",\"凉山彝族自治州\",\"宜宾市\",\"内江市\",\"德阳市\",\"绵阳市\",\"雅安市\",\"乐山市\",\"成都市\",\"眉山市\"],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"},\"show\":false},\"axisTick\":[{\"show\":false}],\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":\"14\",\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"bar\",\"barMaxWidth\":20,\"barWidth\":12,\"data\":[24942,27375,27502,27987,40481,46735,103180,611738,1088026,2739900],\"itemStyle\":{\"normal\":{\"label\":{\"show\":false,\"position\":\"inside\"}}}}]}";
    public static String PIC4 = "{\"color\":[\"#FFD045\",\"#597EF7\",\"#00BE8A\",\"#1FA8F8\",\"#F759AB\"],\"title\":{\"show\":true,\"link\":\"\",\"target\":\"self\",\"text\":\"单位:人\",\"x\":\"left\",\"padding\":[5,0,20,8],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[\"洪雅县\",\"柳江古镇\",\"七里坪\",\"瓦屋山\",\"玉屏山\"],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"},\"botom\":20},\"grid\":{\"top\":\"13%\",\"left\":10,\"right\":\"5%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"category\",\"boundaryGap\":false,\"data\":[\"05-01\",\"05-02\",\"05-03\",\"05-04\",\"05-05\"],\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}}}],\"yAxis\":[{\"type\":\"value\",\"data\":[],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisTick\":{\"show\":false},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"line\",\"symbolSize\":6,\"name\":\"洪雅县\",\"data\":[55713,65149,60626,53389,41435],\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#FFD045\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"柳江古镇\",\"data\":[9868,15220,13337,9905,4515],\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#597EF7\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"七里坪\",\"data\":[9246,12469,12597,10178,5696],\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#00BE8A\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"瓦屋山\",\"data\":[5888,8577,7576,5274,2634],\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#1FA8F8\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"玉屏山\",\"data\":[2684,3621,3219,2441,1474],\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#F759AB\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}}]}";
    public static String PIC5 = "{"legend":{"bottom":55,"orient":"vertical","left":"75%","top":"center","icon":"circle","data":["其他","餐饮","娱乐","购物","住宿"],"itemGap":25,"itemWidth":8,"itemHeight":8,"selectedMode":false,"textStyle":{"color":"#607A8D","rich":{"a":{},"b":{"align":"right"},"c":{"align":"right"}}}},series:[{type:'pie',center:['50%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=["#13C2C2","#40A9FF","#597EF7","#9254DE","#F759AB"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},"data":[{"name":"其他","value":2505720.92},{"name":"餐饮","value":4459469.52},{"name":"娱乐","value":17378851.2},{"name":"购物","value":132115277.82},{"name":"住宿","value":302327847.76}],}]}";
    public static String PIC6 = "{\"legend\":{\"bottom\":15,\"icon\":\"circle\",\"itemGap\":25,\"itemWidth\":8,\"itemHeight\":8,\"selectedMode\":false,\"data\":[{\"name\":\"省内\",\"value\":239569371.98},{\"name\":\"省外\",\"value\":208312374.12}]},series:[{type:'pie',center:['50%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#13C2C2\",\"#40A9FF\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},\"data\":[{\"name\":\"省内\",\"value\":239569371.98},{\"name\":\"省外\",\"value\":208312374.12}],}]}";
    public static String PIC7 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：万元\",\"type\":\"category\",\"data\":[\"南充市\",\"绵阳市\",\"宜宾市\",\"自贡市\",\"资阳市\",\"雅安市\",\"遂宁市\",\"德阳市\",\"乐山市\",\"成都市\"]},\"series\":[{\"type\":\"bar\",\"data\":[\"271.91\",\"287.48\",\"315.34\",\"319.52\",\"333.17\",\"474.45\",\"783.02\",\"934.72\",\"3867.60\",\"15209.59\"]}]}";
    public static String PIC8 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：万元\",\"type\":\"category\",\"data\":[\"南充市\",\"绵阳市\",\"宜宾市\",\"自贡市\",\"资阳市\",\"雅安市\",\"遂宁市\",\"德阳市\",\"乐山市\",\"成都市\"]},\"series\":[{\"type\":\"bar\",\"data\":[\"271.91\",\"287.48\",\"315.34\",\"319.52\",\"333.17\",\"474.45\",\"783.02\",\"934.72\",\"3867.60\",\"15209.59\"]}]}";
    public static String PIC9 = "{\"noDataLoadingOption\":{\"text\":\"暂无数据\",\"effect\":\"bubble\",\"effectOption\":{\"effect\":{\"n\":0}}},\"grid\":{\"top\":\"40px\",\"bottom\":\"60px\",\"right\":\"40px\",\"left\":\"80px\",\"containLabel\":false},\"xAxis\":[{\"axisTick\":{\"alignWithLabel\":true},\"axisLabel\":{\"textStyle\":{\"color\":\"rgba(85, 85, 85, 1)\"}},\"axisLine\":{\"lineStyle\":{\"color\":\"#BBBBBB\"}},\"type\":\"category\",\"data\":[\"2020-05-01\",\"2020-05-02\",\"2020-05-03\",\"2020-05-04\",\"2020-05-05\",\"2020-05-06\",\"2020-05-07\",\"2020-05-08\",\"2020-05-09\"]}],\"yAxis\":[{\"type\":\"value\",\"axisLabel\":{\"textStyle\":{\"color\":\"rgba(85, 85, 85, 1)\"}},\"axisLine\":{\"lineStyle\":{\"color\":\"#BBBBBB\"}},\"splitLine\":{\"show\":true,\"lineStyle\":{\"type\":\"dashed\",\"color\":\"rgba(238,238,238,1)\"}},\"name\":\"车流总量：117544辆\"}],\"series\":[{\"name\":\"车流量\",\"type\":\"line\",\"data\":[18372,16176,16073,13855,13493,11456,12140,12064,3915],\"lineStyle\":{\"color\":\"rgba(0, 190, 138, 1)\"},\"color\":\"rgba(0, 190, 138, 1)\",\"symbol\":\"emptyCircle\",\"symbolSize\":8,\"areaStyle\":{\"normal\":{\"color\":{\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"type\":\"linear\",\"global\":false,\"colorStops\":[{\"offset\":0,\"color\":\"rgba(0, 190, 138, 1)\"},{\"offset\":1,\"color\":\"rgba(0, 190, 138, 0)\"}]}}}}]}";
    public static String PIC10 = "{\"tooltip\":{\"trigger\":\"axis\"},\"grid\":{\"left\":\"2%\",\"right\":\"2%\",\"top\":\"5%\",\"bottom\":\"5%\",\"containLabel\":true},\"xAxis\":[{\"type\":\"category\",\"boundaryGap\":true,\"data\":[\"2020-05-01\",\"2020-05-02\",\"2020-05-03\",\"2020-05-04\",\"2020-05-05\",\"2020-05-06\",\"2020-05-07\",\"2020-05-08\"],\"axisLabel\":{\"show\":true,\"textStyle\":{\"color\":\"#666666\",\"fontSize\":12}},\"axisLine\":{\"lineStyle\":{\"color\":\"#666666\",\"width\":0.5}},\"axisTick\":{\"show\":false}}],\"yAxis\":[{\"type\":\"value\",\"axisLine\":{\"show\":false},\"axisLabel\":{\"show\":true,\"textStyle\":{\"color\":\"#666666\"}},\"splitLine\":{\"show\":true,\"lineStyle\":{\"type\":\"dashed\"}},\"axisTick\":{\"show\":false}}],\"series\":[{\"name\":\"当日累计接待\",\"type\":\"line\",\"stack\":100,\"color\":\"#33ADFC\",\"symbolSize\":6,\"data\":[38844,45190,48848,53744,52523,3576,3858,4227]}]}";
    public static String PIC11 = "{\"color\":[\"#13C2C2\"],\"title\":{\"show\":false,\"link\":\"\",\"target\":\"self\",\"text\":\"\",\"x\":\"left\",\"padding\":[25,0,0,5],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"}},\"grid\":{\"top\":15,\"left\":10,\"right\":\"5%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"category\",\"boundaryGap\":true,\"data\":[\"50后\",\"60后\",\"70后\",\"80后\",\"90后\",\"00后\"],\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}}}],\"yAxis\":[{\"type\":\"value\",\"data\":[],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisTick\":{\"show\":false},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"bar\",\"barMaxWidth\":20,\"data\":[377691,838280,1163825,1781271,1450052,184618]}]}";
    public static String PIC12 = "{\"legend\":{\"bottom\":55,\"orient\":\"vertical\",\"left\":\"75%\",\"top\":\"center\",\"icon\":\"circle\",\"data\":[\"未过夜\",\"1天\",\"2天\",\"3天\",\"4天及以上\"],\"itemGap\":25,\"itemWidth\":8,\"itemHeight\":8,\"selectedMode\":false,\"textStyle\":{\"color\":\"#607A8D\",\"rich\":{\"a\":{},\"b\":{\"align\":\"right\"},\"c\":{\"align\":\"right\"}}}},series:[{type:'pie',center:['50%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#40A9FF\",\"#F2B50E\",\"#F655AA\",\"#9254DE\",\"#597EF7\",\"#13C2C2\",\"#6CBA52\",\"#097C25\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},data:[{\"name\":\"未过夜\",\"value\":16537},{\"name\":\"1天\",\"value\":83724},{\"name\":\"2天\",\"value\":9681},{\"name\":\"3天\",\"value\":3079},{\"name\":\"4天及以上\",\"value\":3755}],}]}";
    */

    public static String PIC1 = "{title:[{text:'{name|'+'县域客流量'+'}\\n{val|'+allPassenger+'}',top:'center',left:'center',textStyle:{rich:{name:{fontSize:24,fontWeight:'normal',color:'#666666',padding:[10,0]},val:{fontSize:32,fontWeight:'bold',color:'#333333',}}}}],\"legend\":{bottom:55,\"orient\":\"vertical\",\"bottom\":\"center\",\"icon\":\"circle\",\"left\":\"75%\",\"data\":[\"省内\",\"省外\",\"境外\"],\"itemGap\":25,\"selectedMode\":false,\"textStyle\":{\"color\":\"#607A8D\",\"rich\":{\"a\":{},\"b\":{\"align\":\"right\"},\"c\":{\"align\":\"right\"}}}},series:[{type:'pie',center:['50%','50%'],radius:['60%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#40A9FF\",\"#F2B50E\",\"#F655AA\",\"#9254DE\",\"#597EF7\",\"#13C2C2\",\"#6CBA52\",\"#097C25\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},data:[{name:\"省内\",value:provinceInner},{name:\"省外\",value:provinceOuter},{name:\"境外\",value:countryOuter}],}]}";
    public static String PIC2 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：人次\",\"type\":\"category\",\"data\":barNameArray},\"series\":[{\"type\":\"bar\",\"data\":barValueArray,\"itemStyle\":{\"normal\":{\"label\":{\"show\":true,\"position\":\"right\"}}}}]}";
    public static String PIC3 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：人次\",\"type\":\"category\",\"data\":barNameArray},\"series\":[{\"type\":\"bar\",\"data\":barValueArray,\"itemStyle\":{\"normal\":{\"label\":{\"show\":true,\"position\":\"right\"}}}}]}";
    public static String PIC4 = "{\"color\":[\"#FFD045\",\"#6600FF\",\"#597EF7\",\"#00BE8A\",\"#1FA8F8\",\"#F759AB\",\"#FF9933\"],\"title\":{\"show\":true,\"link\":\"\",\"target\":\"self\",\"text\":\"单位:人\",\"x\":\"left\",\"padding\":[5,0,20,8],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[\"洪雅县\",\"主城区\",\"柳江古镇\",\"七里坪\",\"瓦屋山\",\"玉屏山\",\"槽渔滩\"],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"},\"botom\":20},\"grid\":{\"top\":\"13%\",\"left\":10,\"right\":\"5%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"category\",\"boundaryGap\":false,\"data\":lineNameArray,\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}}}],\"yAxis\":[{\"type\":\"value\",\"data\":[],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisTick\":{\"show\":false},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"line\",\"symbolSize\":6,\"name\":\"洪雅县\",\"data\":hongYaXian,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#FFD045\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"主城区\",\"data\":zhuChengQu,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#6600FF\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"柳江古镇\",\"data\":liuJiangGuZhen,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#597EF7\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"七里坪\",\"data\":qiLiPing,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#00BE8A\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"瓦屋山\",\"data\":waWuShan,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#1FA8F8\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"玉屏山\",\"data\":yuPingShan,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#F759AB\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}},{\"type\":\"line\",\"symbolSize\":6,\"name\":\"槽渔滩\",\"data\":caoYuTan,\"areaStyle\":{\"normal\":{\"color\":{\"type\":\"linear\",\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"colorStops\":[{\"offset\":0,\"color\":\"#FF9933\"},{\"offset\":1,\"color\":\"white\"}],\"globalCoord\":false},\"opacity\":0.2}}}]}";
    public static String PIC5 = "{\"legend\":{\"bottom\":55,\"orient\":\"vertical\",\"left\":\"75%\",\"top\":\"center\",\"icon\":\"circle\",\"data\":pieNameArray,\"itemGap\":25,\"itemWidth\":8,\"itemHeight\":8,\"selectedMode\":false,\"textStyle\":{\"color\":\"#607A8D\",\"rich\":{\"a\":{},\"b\":{\"align\":\"right\"},\"c\":{\"align\":\"right\"}}}},series:[{type:'pie',center:['40%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#13C2C2\",\"#40A9FF\",\"#597EF7\",\"#9254DE\",\"#F759AB\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},\"data\":pieValueArray}]}";
    public static String PIC6 = "{\"legend\":{\"bottom\":15,\"icon\":\"circle\",\"itemGap\":25,\"itemWidth\":8,\"itemHeight\":8,\"selectedMode\":false,\"data\":pieNameArray},series:[{type:'pie',center:['50%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#13C2C2\",\"#40A9FF\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},\"data\":pieValueArray}]}";
    public static String PIC7 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：万元\",\"type\":\"category\",\"data\":barNameArray},\"series\":[{\"type\":\"bar\",\"data\":barValueArray,\"itemStyle\":{\"normal\":{\"label\":{\"show\":true,\"position\":\"right\"}}}}]}";
    public static String PIC8 = "{\"color\":[\"#38A0FF\",\"#4CCA73\"],\"tooltip\":{\"trigger\":\"axis\",\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"bottom\":\"bottom\"},\"grid\":{\"left\":\"3%\",\"right\":\"4%\",\"bottom\":\"15%\",\"containLabel\":true},\"xAxis\":{\"type\":\"value\"},\"yAxis\":{\"name\":\"单位：万元\",\"type\":\"category\",\"data\":barNameArray},\"series\":[{\"type\":\"bar\",\"data\":barValueArray,\"itemStyle\":{\"normal\":{\"label\":{\"show\":true,\"position\":\"right\"}}}}]}";
    public static String PIC9 = "{\"noDataLoadingOption\":{\"text\":\"暂无数据\",\"effect\":\"bubble\",\"effectOption\":{\"effect\":{\"n\":0}}},\"grid\":{\"top\":\"40px\",\"bottom\":\"60px\",\"right\":\"40px\",\"left\":\"80px\",\"containLabel\":false},\"xAxis\":[{\"axisTick\":{\"alignWithLabel\":true},\"axisLabel\":{\"textStyle\":{\"color\":\"rgba(85, 85, 85, 1)\"}},\"axisLine\":{\"lineStyle\":{\"color\":\"#BBBBBB\"}},\"type\":\"category\",\"data\":lineNameArray}],\"yAxis\":[{\"type\":\"value\",\"axisLabel\":{\"textStyle\":{\"color\":\"rgba(85, 85, 85, 1)\"}},\"axisLine\":{\"lineStyle\":{\"color\":\"#BBBBBB\"}},\"splitLine\":{\"show\":true,\"lineStyle\":{\"type\":\"dashed\",\"color\":\"rgba(238,238,238,1)\"}},\"name\":\"\"}],\"series\":[{\"name\":\"车流量\",\"type\":\"line\",\"data\":lineValueArray,\"lineStyle\":{\"color\":\"rgba(0, 190, 138, 1)\"},\"color\":\"rgba(0, 190, 138, 1)\",\"symbol\":\"emptyCircle\",\"symbolSize\":8,\"areaStyle\":{\"normal\":{\"color\":{\"x\":0,\"y\":0,\"x2\":0,\"y2\":1,\"type\":\"linear\",\"global\":false,\"colorStops\":[{\"offset\":0,\"color\":\"rgba(0, 190, 138, 1)\"},{\"offset\":1,\"color\":\"rgba(0, 190, 138, 0)\"}]}}}}]}";
    public static String PIC10 = "{\"tooltip\":{\"trigger\":\"axis\"},\"grid\":{\"left\":\"2%\",\"right\":\"2%\",\"top\":\"5%\",\"bottom\":\"5%\",\"containLabel\":true},\"xAxis\":[{\"type\":\"category\",\"boundaryGap\":true,\"data\":lineNameArray,\"axisLabel\":{\"show\":true,\"textStyle\":{\"color\":\"#666666\",\"fontSize\":12}},\"axisLine\":{\"lineStyle\":{\"color\":\"#666666\",\"width\":0.5}},\"axisTick\":{\"show\":false}}],\"yAxis\":[{\"type\":\"value\",\"axisLine\":{\"show\":false},\"axisLabel\":{\"show\":true,\"textStyle\":{\"color\":\"#666666\"}},\"splitLine\":{\"show\":true,\"lineStyle\":{\"type\":\"dashed\"}},\"axisTick\":{\"show\":false}}],\"series\":[{\"name\":\"当日累计接待\",\"type\":\"line\",\"stack\":100,\"color\":\"#33ADFC\",\"symbolSize\":6,\"data\":lineValueArray}]}";
    public static String PIC11 = "{\"color\":[\"#13C2C2\"],\"title\":{\"show\":false,\"link\":\"\",\"target\":\"self\",\"text\":\"\",\"x\":\"left\",\"padding\":[25,0,0,5],\"textStyle\":{\"fontSize\":12,\"fontWeight\":\"normal\",\"fontFamily\":\"Microsoft Yahei\"}},\"tooltip\":{\"trigger\":\"axis\",\"padding\":[10,10,10,10],\"axisPointer\":{\"type\":\"shadow\"}},\"legend\":{\"padding\":[15,0,0,0],\"itemGap\":5,\"itemWidth\":25,\"itemHeight\":12,\"width\":\"auto\",\"show\":true,\"left\":\"auto\",\"right\":\"50\",\"bottom\":\"auto\",\"top\":\"0\",\"data\":[],\"textStyle\":{\"color\":\"#607A8D\",\"fontSize\":14,\"fontFamily\":\"Microsoft Yahei\"}},\"grid\":{\"top\":15,\"left\":10,\"right\":\"5%\",\"bottom\":15,\"containLabel\":true},\"xAxis\":[{\"name\":\"\",\"type\":\"category\",\"boundaryGap\":true,\"data\":barNameArray,\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"axisTick\":{\"show\":false},\"splitLine\":{\"lineStyle\":{\"color\":\"#DDE0E5\"}}}],\"yAxis\":[{\"type\":\"value\",\"data\":[],\"name\":\"\",\"axisLine\":{\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisTick\":{\"show\":false},\"axisLabel\":{\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"lineStyle\":{\"color\":\"#F7F9FA\"}}},{\"type\":\"value\",\"name\":\"\",\"data\":[],\"axisLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#E9EEF2\"}},\"axisLabel\":{\"show\":false,\"color\":\"#88A3B4\",\"textStyle\":{\"fontSize\":12,\"fontFamily\":\"Microsoft Yahei\"}},\"splitLine\":{\"show\":false,\"lineStyle\":{\"color\":\"#F7F9FA\"}}}],\"series\":[{\"type\":\"bar\",\"barMaxWidth\":20,\"data\":barValueArray}]}";
    public static String PIC12 = "{\"legend\":{\"bottom\":55,\"orient\":\"vertical\",\"left\":\"75%\",\"top\":\"center\",\"icon\":\"circle\",\"data\":pieNameArray,\"itemGap\":25,\"itemWidth\":8,\"itemHeight\":8,\"selectedMode\":false,\"textStyle\":{\"color\":\"#607A8D\",\"rich\":{\"a\":{},\"b\":{\"align\":\"right\"},\"c\":{\"align\":\"right\"}}}},series:[{type:'pie',center:['50%','50%'],radius:['0%','75%'],clockwise:true,avoidLabelOverlap:true,hoverOffset:15,itemStyle:{normal:{color:function(params){var colorList=[\"#40A9FF\",\"#F2B50E\",\"#F655AA\",\"#9254DE\",\"#597EF7\",\"#13C2C2\",\"#6CBA52\",\"#097C25\"];return colorList[params.dataIndex];}}},label:{show:true,position:'outside',formatter:'{a|{b}：{d}%}\\n{hr|}',rich:{hr:{backgroundColor:'t',borderRadius:3,width:3,height:3,padding:[3,3,0,-12]},a:{padding:[-30,15,-20,15]}}},labelLine:{normal:{length:20,length2:30,lineStyle:{width:1}}},data:pieValueArray}]}";

    public static void main(String[] args) {
        // 模拟数据准备
        String dataStr = "{\"code\":\"08010000\",\"message\":\"操作成功\",\"success\":true,\"data\":{\"overview\":{\"dateRange\":\"2020-04-01至2020-04-30\",\"passenger\":75.0997,\"passengerByScenic\":\"主城区11.37万人次,柳江古镇7.05万人次,七里坪6.76万人次,槽渔滩4.54万人次,瓦屋山4.29万人次,玉屏山3.14万人次\",\"consumption\":11566.04,\"consumptionByBusinessCircle\":\"县城区域商圈6771.44万元、七里坪商圈2797.16万元、柳江商圈627.91万元、瓦屋山商圈572.57万元、槽渔滩商圈3.77万元。\",\"businessCircleData\":[{\"cbdName\":\"洪雅县域\",\"transAt\":115660412.36,\"transNum\":559112,\"acctNum\":122630,\"transAtAvg\":943.17,\"transNumAvg\":4.56},{\"cbdName\":\"县城区域商圈\",\"transAt\":67714409.84,\"transNum\":401212,\"acctNum\":89096,\"transAtAvg\":760.02,\"transNumAvg\":4.50},{\"cbdName\":\"七里坪商圈\",\"transAt\":27971597.00,\"transNum\":94976,\"acctNum\":18684,\"transAtAvg\":1497.09,\"transNumAvg\":5.08},{\"cbdName\":\"柳江商圈\",\"transAt\":6279140.28,\"transNum\":22748,\"acctNum\":5179,\"transAtAvg\":1212.42,\"transNumAvg\":4.39},{\"cbdName\":\"瓦屋山商圈\",\"transAt\":5725720.50,\"transNum\":2572,\"acctNum\":1696,\"transAtAvg\":3376.01,\"transNumAvg\":1.52},{\"cbdName\":\"槽渔滩商圈\",\"transAt\":37679.00,\"transNum\":1988,\"acctNum\":399,\"transAtAvg\":94.43,\"transNumAvg\":4.98}]},\"pfa\":{\"piePassengerSource\":{\"provinceInner\":1219133,\"provinceOuter\":107834,\"countryOuter\":118},\"passengerInProvince\":\"121\",\"ratioInProvince\":\"91.87\",\"barPassengerInProvince\":[{\"name\":\"眉山市\",\"value\":580629},{\"name\":\"成都市\",\"value\":322653},{\"name\":\"乐山市\",\"value\":156722},{\"name\":\"雅安市\",\"value\":37958},{\"name\":\"德阳市\",\"value\":20534}],\"top5PassengerInProvince\":\"眉山市（58.06）万人次、成都市（32.27）万人次、乐山市（15.67）万人次、雅安市（3.8）万人次、德阳市（2.05）万人次\",\"barPassengerOutsideProvince\":[{\"name\":\"广东\",\"value\":16070},{\"name\":\"重庆\",\"value\":14868},{\"name\":\"上海\",\"value\":12230},{\"name\":\"江苏\",\"value\":7624},{\"name\":\"浙江\",\"value\":6475}],\"top5PassengerOutsideProvince\":\"广东（16070）人次、重庆（14868）人次、上海（12230）人次、江苏（7624）人次、浙江（6475）人次\",\"linePassengerFlowByScenic\":{\"qiLiPing\":[{\"name\":\"4-1\",\"value\":1621},{\"name\":\"4-2\",\"value\":1385},{\"name\":\"4-3\",\"value\":1674},{\"name\":\"4-4\",\"value\":2639},{\"name\":\"4-5\",\"value\":3152},{\"name\":\"4-6\",\"value\":2612},{\"name\":\"4-7\",\"value\":1815},{\"name\":\"4-8\",\"value\":1937},{\"name\":\"4-9\",\"value\":2056},{\"name\":\"4-10\",\"value\":2203},{\"name\":\"4-11\",\"value\":2716},{\"name\":\"4-12\",\"value\":2630},{\"name\":\"4-13\",\"value\":1771},{\"name\":\"4-14\",\"value\":1967},{\"name\":\"4-15\",\"value\":2150},{\"name\":\"4-16\",\"value\":2076},{\"name\":\"4-17\",\"value\":2226},{\"name\":\"4-18\",\"value\":2982},{\"name\":\"4-19\",\"value\":2493},{\"name\":\"4-20\",\"value\":1688},{\"name\":\"4-21\",\"value\":1717},{\"name\":\"4-22\",\"value\":1843},{\"name\":\"4-23\",\"value\":1822},{\"name\":\"4-24\",\"value\":2238},{\"name\":\"4-25\",\"value\":2468},{\"name\":\"4-26\",\"value\":2063},{\"name\":\"4-27\",\"value\":2128},{\"name\":\"4-28\",\"value\":2293},{\"name\":\"4-29\",\"value\":2641},{\"name\":\"4-30\",\"value\":4632}],\"zhuChengQu\":[{\"name\":\"4-26\",\"value\":17561},{\"name\":\"4-27\",\"value\":22322},{\"name\":\"4-28\",\"value\":23466},{\"name\":\"4-29\",\"value\":23009},{\"name\":\"4-30\",\"value\":27342}],\"liuJiangGuZhen\":[{\"name\":\"4-1\",\"value\":1576},{\"name\":\"4-2\",\"value\":1395},{\"name\":\"4-3\",\"value\":1405},{\"name\":\"4-4\",\"value\":3290},{\"name\":\"4-5\",\"value\":4122},{\"name\":\"4-6\",\"value\":2779},{\"name\":\"4-7\",\"value\":1490},{\"name\":\"4-8\",\"value\":1871},{\"name\":\"4-9\",\"value\":1861},{\"name\":\"4-10\",\"value\":2203},{\"name\":\"4-11\",\"value\":3020},{\"name\":\"4-12\",\"value\":3071},{\"name\":\"4-13\",\"value\":1437},{\"name\":\"4-14\",\"value\":1936},{\"name\":\"4-15\",\"value\":1881},{\"name\":\"4-16\",\"value\":1985},{\"name\":\"4-17\",\"value\":2027},{\"name\":\"4-18\",\"value\":3774},{\"name\":\"4-19\",\"value\":3058},{\"name\":\"4-20\",\"value\":1809},{\"name\":\"4-21\",\"value\":1538},{\"name\":\"4-22\",\"value\":1936},{\"name\":\"4-23\",\"value\":1639},{\"name\":\"4-24\",\"value\":2487},{\"name\":\"4-25\",\"value\":2792},{\"name\":\"4-26\",\"value\":2536},{\"name\":\"4-27\",\"value\":2299},{\"name\":\"4-28\",\"value\":3027},{\"name\":\"4-29\",\"value\":2830},{\"name\":\"4-30\",\"value\":3470}],\"caoYuTan\":[{\"name\":\"4-1\",\"value\":1324},{\"name\":\"4-2\",\"value\":1250},{\"name\":\"4-3\",\"value\":1268},{\"name\":\"4-4\",\"value\":2504},{\"name\":\"4-5\",\"value\":2420},{\"name\":\"4-6\",\"value\":1802},{\"name\":\"4-7\",\"value\":1240},{\"name\":\"4-8\",\"value\":1499},{\"name\":\"4-9\",\"value\":1292},{\"name\":\"4-10\",\"value\":1425},{\"name\":\"4-11\",\"value\":1695},{\"name\":\"4-12\",\"value\":1867},{\"name\":\"4-13\",\"value\":1253},{\"name\":\"4-14\",\"value\":1432},{\"name\":\"4-15\",\"value\":1219},{\"name\":\"4-16\",\"value\":1460},{\"name\":\"4-17\",\"value\":1251},{\"name\":\"4-18\",\"value\":1986},{\"name\":\"4-19\",\"value\":1524},{\"name\":\"4-20\",\"value\":1460},{\"name\":\"4-21\",\"value\":1094},{\"name\":\"4-22\",\"value\":1448},{\"name\":\"4-23\",\"value\":1231},{\"name\":\"4-24\",\"value\":1629},{\"name\":\"4-25\",\"value\":1514},{\"name\":\"4-26\",\"value\":1521},{\"name\":\"4-27\",\"value\":1209},{\"name\":\"4-28\",\"value\":1526},{\"name\":\"4-29\",\"value\":1378},{\"name\":\"4-30\",\"value\":1636}],\"hongYaXian\":[{\"name\":\"4-1\",\"value\":20554},{\"name\":\"4-2\",\"value\":17581},{\"name\":\"4-3\",\"value\":21050},{\"name\":\"4-4\",\"value\":30641},{\"name\":\"4-5\",\"value\":33585},{\"name\":\"4-6\",\"value\":26551},{\"name\":\"4-7\",\"value\":21825},{\"name\":\"4-8\",\"value\":22534},{\"name\":\"4-9\",\"value\":22570},{\"name\":\"4-10\",\"value\":22734},{\"name\":\"4-11\",\"value\":24734},{\"name\":\"4-12\",\"value\":25359},{\"name\":\"4-13\",\"value\":19699},{\"name\":\"4-14\",\"value\":21910},{\"name\":\"4-15\",\"value\":23180},{\"name\":\"4-16\",\"value\":23099},{\"name\":\"4-17\",\"value\":23736},{\"name\":\"4-18\",\"value\":28229},{\"name\":\"4-19\",\"value\":25570},{\"name\":\"4-20\",\"value\":22285},{\"name\":\"4-21\",\"value\":20524},{\"name\":\"4-22\",\"value\":22484},{\"name\":\"4-23\",\"value\":21044},{\"name\":\"4-24\",\"value\":23983},{\"name\":\"4-25\",\"value\":25856},{\"name\":\"4-26\",\"value\":24133},{\"name\":\"4-27\",\"value\":30627},{\"name\":\"4-28\",\"value\":32651},{\"name\":\"4-29\",\"value\":32261},{\"name\":\"4-30\",\"value\":40008}],\"yuPingShan\":[{\"name\":\"4-1\",\"value\":969},{\"name\":\"4-2\",\"value\":573},{\"name\":\"4-3\",\"value\":724},{\"name\":\"4-4\",\"value\":1376},{\"name\":\"4-5\",\"value\":1759},{\"name\":\"4-6\",\"value\":1216},{\"name\":\"4-7\",\"value\":934},{\"name\":\"4-8\",\"value\":1000},{\"name\":\"4-9\",\"value\":1056},{\"name\":\"4-10\",\"value\":926},{\"name\":\"4-11\",\"value\":1129},{\"name\":\"4-12\",\"value\":1395},{\"name\":\"4-13\",\"value\":1002},{\"name\":\"4-14\",\"value\":1013},{\"name\":\"4-15\",\"value\":1018},{\"name\":\"4-16\",\"value\":928},{\"name\":\"4-17\",\"value\":910},{\"name\":\"4-18\",\"value\":1322},{\"name\":\"4-19\",\"value\":1020},{\"name\":\"4-20\",\"value\":870},{\"name\":\"4-21\",\"value\":716},{\"name\":\"4-22\",\"value\":843},{\"name\":\"4-23\",\"value\":770},{\"name\":\"4-24\",\"value\":1088},{\"name\":\"4-25\",\"value\":1370},{\"name\":\"4-26\",\"value\":1033},{\"name\":\"4-27\",\"value\":863},{\"name\":\"4-28\",\"value\":1268},{\"name\":\"4-29\",\"value\":1089},{\"name\":\"4-30\",\"value\":1180}],\"waWuShan\":[{\"name\":\"4-1\",\"value\":999},{\"name\":\"4-2\",\"value\":748},{\"name\":\"4-3\",\"value\":789},{\"name\":\"4-4\",\"value\":1538},{\"name\":\"4-5\",\"value\":2316},{\"name\":\"4-6\",\"value\":1484},{\"name\":\"4-7\",\"value\":1207},{\"name\":\"4-8\",\"value\":1413},{\"name\":\"4-9\",\"value\":1811},{\"name\":\"4-10\",\"value\":1177},{\"name\":\"4-11\",\"value\":1459},{\"name\":\"4-12\",\"value\":1781},{\"name\":\"4-13\",\"value\":1050},{\"name\":\"4-14\",\"value\":1380},{\"name\":\"4-15\",\"value\":1454},{\"name\":\"4-16\",\"value\":1550},{\"name\":\"4-17\",\"value\":1409},{\"name\":\"4-18\",\"value\":2090},{\"name\":\"4-19\",\"value\":1573},{\"name\":\"4-20\",\"value\":1063},{\"name\":\"4-21\",\"value\":835},{\"name\":\"4-22\",\"value\":985},{\"name\":\"4-23\",\"value\":998},{\"name\":\"4-24\",\"value\":1567},{\"name\":\"4-25\",\"value\":1866},{\"name\":\"4-26\",\"value\":1703},{\"name\":\"4-27\",\"value\":1466},{\"name\":\"4-28\",\"value\":1662},{\"name\":\"4-29\",\"value\":1557},{\"name\":\"4-30\",\"value\":1923}]},\"firstFavoriteScenic\":\"主城区\",\"secondFavoriteScenic\":\"柳江古镇\",\"thirdFavoriteScenic\":\"七里坪\",\"passengerInWawu\":6609},\"tca\":{\"highestBusiness\":\"住宿\",\"highestBusinessConsumption\":8134.72,\"highestBusinessRatio\":70.33,\"higherBusiness\":\"购物\",\"higherBusinessConsumption\":2463.92,\"higherBusinessRatio\":21.3,\"industryData\":[{\"industry\":\"住宿\",\"transAt\":81347229.80,\"sameTimeLastYear\":172745479.24,\"yearOnYear\":-0.5291,\"transAtRatio\":1.0000,\"acctNum\":73590,\"perAcctTransAt\":1105.41},{\"industry\":\"购物\",\"transAt\":24639172.14,\"sameTimeLastYear\":24819684.36,\"yearOnYear\":-0.0073,\"transAtRatio\":0.1427,\"acctNum\":39733,\"perAcctTransAt\":620.12},{\"industry\":\"娱乐\",\"transAt\":8513400.08,\"sameTimeLastYear\":2641109.14,\"yearOnYear\":2.2234,\"transAtRatio\":0.3086,\"acctNum\":2447,\"perAcctTransAt\":3479.12},{\"industry\":\"餐饮\",\"transAt\":814290.78,\"sameTimeLastYear\":4081748.84,\"yearOnYear\":-0.8005,\"transAtRatio\":0.1148,\"acctNum\":4039,\"perAcctTransAt\":201.61},{\"industry\":\"其他\",\"transAt\":346319.54,\"sameTimeLastYear\":152248.82,\"yearOnYear\":1.2747,\"transAtRatio\":0.1800,\"acctNum\":2814,\"perAcctTransAt\":123.07}],\"consumptionInProvince\":5949.87,\"consumptionInProvinceRatio\":51.44,\"consumptionOutsideProvince\":5616.17,\"consumptionOutsideProvinceRatio\":48.56,\"top5ConsumptionInProvince\":\"成都市（3792.63万元）、乐山市（1215.47万元）、德阳市（188.58万元）、雅安市（168.68万元）、自贡市（95.45万元）。\",\"top5ConsumptionOutsideProvince\":\"广东省（962.25万元）、云南省（419.43万元）、福建省（364.38万元）、吉林省（347.81万元）、上海市（340.81万元）。\",\"sourceData\":{\"totalTransAt\":115660463.16,\"innerProvTransAt\":59498713.30,\"innerProvList\":[{\"source\":\"成都市\",\"transAt\":37926256.96,\"sameTimeLastYear\":80567025.96,\"yearOnYear\":-0.5293,\"proportion\":0.6374,\"acctNum\":36926,\"perAcctTransAt\":1027.09},{\"source\":\"乐山市\",\"transAt\":12154681.66,\"sameTimeLastYear\":5535844.91,\"yearOnYear\":1.1956,\"proportion\":0.2043,\"acctNum\":7215,\"perAcctTransAt\":1684.64},{\"source\":\"德阳市\",\"transAt\":1885845.10,\"sameTimeLastYear\":1626511.01,\"yearOnYear\":0.1594,\"proportion\":0.0317,\"acctNum\":1446,\"perAcctTransAt\":1304.18},{\"source\":\"雅安市\",\"transAt\":1686795.20,\"sameTimeLastYear\":1206682.53,\"yearOnYear\":0.3979,\"proportion\":0.0284,\"acctNum\":2092,\"perAcctTransAt\":806.31},{\"source\":\"自贡市\",\"transAt\":954466.17,\"sameTimeLastYear\":812409.44,\"yearOnYear\":0.1749,\"proportion\":0.0160,\"acctNum\":865,\"perAcctTransAt\":1103.43},{\"source\":\"遂宁市\",\"transAt\":881414.42,\"sameTimeLastYear\":3306967.68,\"yearOnYear\":-0.7335,\"proportion\":0.0148,\"acctNum\":1133,\"perAcctTransAt\":777.95},{\"source\":\"内江市\",\"transAt\":666670.92,\"sameTimeLastYear\":4338669.64,\"yearOnYear\":-0.8463,\"proportion\":0.0112,\"acctNum\":757,\"perAcctTransAt\":880.67},{\"source\":\"绵阳市\",\"transAt\":527809.95,\"sameTimeLastYear\":2691841.68,\"yearOnYear\":-0.8039,\"proportion\":0.0089,\"acctNum\":1105,\"perAcctTransAt\":477.66},{\"source\":\"南充市\",\"transAt\":515613.73,\"sameTimeLastYear\":496381.86,\"yearOnYear\":0.0387,\"proportion\":0.0087,\"acctNum\":973,\"perAcctTransAt\":529.92},{\"source\":\"泸州市\",\"transAt\":456233.45,\"sameTimeLastYear\":550325.44,\"yearOnYear\":-0.1710,\"proportion\":0.0077,\"acctNum\":840,\"perAcctTransAt\":543.14}],\"outerProvTransAt\":56161749.86,\"outerProvList\":[{\"source\":\"广东省\",\"transAt\":9622497.71,\"sameTimeLastYear\":15506129.42,\"yearOnYear\":-0.3794,\"proportion\":0.1713,\"acctNum\":11604,\"perAcctTransAt\":829.24},{\"source\":\"云南省\",\"transAt\":4194305.48,\"sameTimeLastYear\":1762735.03,\"yearOnYear\":1.3794,\"proportion\":0.0747,\"acctNum\":2761,\"perAcctTransAt\":1519.13},{\"source\":\"福建省\",\"transAt\":3643842.52,\"sameTimeLastYear\":2298371.73,\"yearOnYear\":0.5854,\"proportion\":0.0649,\"acctNum\":2890,\"perAcctTransAt\":1260.85},{\"source\":\"吉林省\",\"transAt\":3478117.12,\"sameTimeLastYear\":423179.54,\"yearOnYear\":7.2190,\"proportion\":0.0619,\"acctNum\":438,\"perAcctTransAt\":7940.91},{\"source\":\"上海市\",\"transAt\":3408059.61,\"sameTimeLastYear\":10496184.47,\"yearOnYear\":-0.6753,\"proportion\":0.0607,\"acctNum\":4493,\"perAcctTransAt\":758.53},{\"source\":\"江苏省\",\"transAt\":3407047.50,\"sameTimeLastYear\":8289588.43,\"yearOnYear\":-0.5890,\"proportion\":0.0607,\"acctNum\":5688,\"perAcctTransAt\":598.99},{\"source\":\"浙江省\",\"transAt\":3282586.86,\"sameTimeLastYear\":4891889.87,\"yearOnYear\":-0.3290,\"proportion\":0.0584,\"acctNum\":3437,\"perAcctTransAt\":955.07},{\"source\":\"甘肃省\",\"transAt\":2837902.61,\"sameTimeLastYear\":491189.42,\"yearOnYear\":4.7776,\"proportion\":0.0505,\"acctNum\":600,\"perAcctTransAt\":4729.84},{\"source\":\"北京市\",\"transAt\":2770209.06,\"sameTimeLastYear\":11619148.92,\"yearOnYear\":-0.7616,\"proportion\":0.0493,\"acctNum\":5241,\"perAcctTransAt\":528.56},{\"source\":\"湖南省\",\"transAt\":2663468.62,\"sameTimeLastYear\":3137201.07,\"yearOnYear\":-0.1510,\"proportion\":0.0474,\"acctNum\":2192,\"perAcctTransAt\":1215.09}]}},\"ta\":{\"lineTrafficFlowTrend\":[{\"name\":\"2020-04-01\",\"value\":5177},{\"name\":\"2020-04-02\",\"value\":11960},{\"name\":\"2020-04-03\",\"value\":13868},{\"name\":\"2020-04-04\",\"value\":16314},{\"name\":\"2020-04-05\",\"value\":14891},{\"name\":\"2020-04-06\",\"value\":13195},{\"name\":\"2020-04-07\",\"value\":13250},{\"name\":\"2020-04-08\",\"value\":13328},{\"name\":\"2020-04-09\",\"value\":13336},{\"name\":\"2020-04-10\",\"value\":14261},{\"name\":\"2020-04-11\",\"value\":13467},{\"name\":\"2020-04-12\",\"value\":12412},{\"name\":\"2020-04-13\",\"value\":11971},{\"name\":\"2020-04-14\",\"value\":11834},{\"name\":\"2020-04-15\",\"value\":12265},{\"name\":\"2020-04-16\",\"value\":12493},{\"name\":\"2020-04-17\",\"value\":12573},{\"name\":\"2020-04-18\",\"value\":11414},{\"name\":\"2020-04-19\",\"value\":12388},{\"name\":\"2020-04-20\",\"value\":12187},{\"name\":\"2020-04-21\",\"value\":10996},{\"name\":\"2020-04-22\",\"value\":11614},{\"name\":\"2020-04-23\",\"value\":11381},{\"name\":\"2020-04-24\",\"value\":7977},{\"name\":\"2020-04-25\",\"value\":12354},{\"name\":\"2020-04-26\",\"value\":10884},{\"name\":\"2020-04-27\",\"value\":10422},{\"name\":\"2020-04-28\",\"value\":11887},{\"name\":\"2020-04-29\",\"value\":11989},{\"name\":\"2020-04-30\",\"value\":16427}],\"heavyArterialTraffic\":\"大峨眉国际旅游西环线（牌坊坝-郭家山庄）（累计拥堵7时35分），西环线牌坊坝路口（天宫路口-牌坊坝）（累计拥堵6时35分）。\",\"trafficFlow\":\"36.85万\",\"top5TrafficSourceInProvince\":\"眉山（19.55万辆），成都（5.09万辆），乐山（2.64万辆），雅安（9413辆），德阳（1164辆）。\",\"top5TrafficSourceOutsideProvince\":\"浙江（7107辆），安徽（3552辆），广东（3313辆），重庆（2050辆），河南（1323辆）。\",\"data\":{\"TA.lineTrafficFlowTrend\":[{\"name\":\"2020-04-30\",\"value\":16427},{\"name\":\"2020-04-04\",\"value\":16314},{\"name\":\"2020-04-05\",\"value\":14891},{\"name\":\"2020-04-10\",\"value\":14261},{\"name\":\"2020-04-03\",\"value\":13868},{\"name\":\"2020-04-11\",\"value\":13467},{\"name\":\"2020-04-09\",\"value\":13336},{\"name\":\"2020-04-08\",\"value\":13328},{\"name\":\"2020-04-07\",\"value\":13250},{\"name\":\"2020-04-06\",\"value\":13195},{\"name\":\"2020-04-17\",\"value\":12573},{\"name\":\"2020-04-16\",\"value\":12493},{\"name\":\"2020-04-12\",\"value\":12412},{\"name\":\"2020-04-19\",\"value\":12388},{\"name\":\"2020-04-25\",\"value\":12354},{\"name\":\"2020-04-15\",\"value\":12265},{\"name\":\"2020-04-20\",\"value\":12187},{\"name\":\"2020-04-29\",\"value\":11989},{\"name\":\"2020-04-13\",\"value\":11971},{\"name\":\"2020-04-02\",\"value\":11960},{\"name\":\"2020-04-28\",\"value\":11887},{\"name\":\"2020-04-14\",\"value\":11834},{\"name\":\"2020-04-22\",\"value\":11614},{\"name\":\"2020-04-18\",\"value\":11414},{\"name\":\"2020-04-23\",\"value\":11381},{\"name\":\"2020-04-21\",\"value\":10996},{\"name\":\"2020-04-26\",\"value\":10884},{\"name\":\"2020-04-27\",\"value\":10422},{\"name\":\"2020-04-24\",\"value\":7977},{\"name\":\"2020-04-01\",\"value\":5177}],\"TA.heavyArterialTraffic\":[{\"name\":\"大峨眉国际旅游西环线（牌坊坝-郭家山庄）\",\"value\":455},{\"name\":\"西环线牌坊坝路口（天宫路口-牌坊坝）\",\"value\":395}],\"TA.trafficFlow\":[{\"name\":\"total\",\"value\":368515}],\"TA.top5TrafficSourceInProvince\":[{\"name\":\"眉山\",\"value\":195515},{\"name\":\"成都\",\"value\":50904},{\"name\":\"乐山\",\"value\":26393},{\"name\":\"雅安\",\"value\":9413},{\"name\":\"德阳\",\"value\":1164}],\"TA.top5TrafficSourceOutsideProvince\":[{\"name\":\"浙江\",\"value\":7107},{\"name\":\"安徽\",\"value\":3552},{\"name\":\"广东\",\"value\":3313},{\"name\":\"重庆\",\"value\":2050},{\"name\":\"河南\",\"value\":1323}]}},\"hca\":{\"checkInAmount\":47.96,\"lineCheckInAmount\":[{\"key\":\"2020-04-01\",\"value\":2984},{\"key\":\"2020-04-02\",\"value\":2832},{\"key\":\"2020-04-03\",\"value\":3316},{\"key\":\"2020-04-04\",\"value\":5430},{\"key\":\"2020-04-05\",\"value\":7100},{\"key\":\"2020-04-06\",\"value\":6891},{\"key\":\"2020-04-07\",\"value\":7274},{\"key\":\"2020-04-08\",\"value\":8375},{\"key\":\"2020-04-09\",\"value\":9258},{\"key\":\"2020-04-10\",\"value\":10472},{\"key\":\"2020-04-11\",\"value\":12231},{\"key\":\"2020-04-12\",\"value\":13283},{\"key\":\"2020-04-13\",\"value\":13350},{\"key\":\"2020-04-14\",\"value\":14245},{\"key\":\"2020-04-15\",\"value\":15232},{\"key\":\"2020-04-16\",\"value\":15704},{\"key\":\"2020-04-17\",\"value\":17005},{\"key\":\"2020-04-18\",\"value\":16981},{\"key\":\"2020-04-19\",\"value\":19643},{\"key\":\"2020-04-20\",\"value\":18541},{\"key\":\"2020-04-21\",\"value\":19953},{\"key\":\"2020-04-22\",\"value\":21327},{\"key\":\"2020-04-23\",\"value\":22407},{\"key\":\"2020-04-24\",\"value\":23766},{\"key\":\"2020-04-25\",\"value\":25501},{\"key\":\"2020-04-26\",\"value\":26259},{\"key\":\"2020-04-27\",\"value\":27598},{\"key\":\"2020-04-28\",\"value\":29211},{\"key\":\"2020-04-29\",\"value\":30663},{\"key\":\"2020-04-30\",\"value\":32803}],\"top5CheckInAmount\":\"洪州大酒店（累计接待25747人次）、洪雅县半岛度假酒店有限责任公司（累计接待18257人次）、洪雅县豪庭酒店有限公司（累计接待16874人次）、洪雅县月光印象酒店（累计接待15327人次）、洪雅七里坪温泉酒店管理有限公司（累计接待13203人次）。\",\"gender\":\"男性\",\"genderRatio\":62.83,\"top3AgeDistribution\":\"80后（占比28.85%），90后（占比23.85%），70后（占比20.45%）。\",\"barCheckInAgeDistribution\":[{\"key\":\"50\",\"value\":4926},{\"key\":\"60\",\"value\":9108},{\"key\":\"70\",\"value\":12028},{\"key\":\"80\",\"value\":16968},{\"key\":\"90\",\"value\":14029},{\"key\":\"00\",\"value\":1758}],\"top3StayOvernight\":\"1天的最多（占比68.99%），其次是未过夜（占比16.33%），第三是过夜数为2天的（占比8.97%）。\",\"pieDataStayOvernight\":[{\"key\":\"未过夜\",\"value\":4931},{\"key\":\"1天\",\"value\":20828},{\"key\":\"2天\",\"value\":2707},{\"key\":\"3天\",\"value\":797},{\"key\":\"4天及以上\",\"value\":927}]}}}";
        Result<SpecialReportWordData> result = JsonUtils.toObject(dataStr, new TypeReference<Result<SpecialReportWordData>>() {});
        SpecialReportWordData data = result.getData();

        // 替换县域游客来源饼图数据
        ScenicReportVO.PassengerFlowAnalysis PFA = data.getPFA();
        ScenicReportVO.PiePassengerSource pie = PFA.getPiePassengerSource();
        int provinceInner = pie.getProvinceInner();
        int provinceOuter = pie.getCountryOuter();
        int countryOuter = pie.getCountryOuter();
        String pic1Options = PIC1.replace("allPassenger",(provinceInner + provinceOuter + countryOuter) + "")
                .replace("provinceInner",provinceInner+"")
                .replace("provinceOuter",provinceOuter+"")
                .replace("countryOuter",countryOuter+"");
        // 替换省内游客柱状图数据
        List<ScenicReportVO.LineChartVO> barPassengerInProvince = PFA.getBarPassengerInProvince();
        List<String> nameList = barPassengerInProvince.stream().map(e -> e.getName()).collect(Collectors.toList());
        List<Integer> valueList = barPassengerInProvince.stream().map(e ->e.getValue()).collect(Collectors.toList());
        Collections.reverse(nameList);
        Collections.reverse(valueList);
        String pic2Options = PIC2.replace("barNameArray",JsonUtils.toJsonString(nameList))
                .replace("barValueArray",JsonUtils.toJsonString(valueList));

        // 替换省外游客柱状图数据
        List<ScenicReportVO.LineChartVO> barPassengerOutsideProvince = PFA.getBarPassengerOutsideProvince();
        List<String> name2List = barPassengerOutsideProvince.stream().map(e -> e.getName()).collect(Collectors.toList());
        List<Integer> value2List = barPassengerOutsideProvince.stream().map(e ->e.getValue()).collect(Collectors.toList());
        Collections.reverse(name2List);
        Collections.reverse(value2List);
        String pic3Options = PIC3.replace("barNameArray",JsonUtils.toJsonString(name2List))
                .replace("barValueArray",JsonUtils.toJsonString(value2List));

        // 客流趋势及景区热度
        ScenicReportVO.LinePassengerFlowByScenic linePassengerFlowByScenic = PFA.getLinePassengerFlowByScenic();
        List<ScenicReportVO.LineChartVO> hongYaXian = linePassengerFlowByScenic.getHongYaXian();
        List<ScenicReportVO.LineChartVO> zhuChengQu = linePassengerFlowByScenic.getZhuChengQu();
        List<ScenicReportVO.LineChartVO> liuJiangGuZhen = linePassengerFlowByScenic.getLiuJiangGuZhen();
        List<ScenicReportVO.LineChartVO> qiLiPing = linePassengerFlowByScenic.getQiLiPing();
        List<ScenicReportVO.LineChartVO> waWuShan = linePassengerFlowByScenic.getWaWuShan();
        List<ScenicReportVO.LineChartVO> yuPingShan = linePassengerFlowByScenic.getYuPingShan();
        List<ScenicReportVO.LineChartVO> caoYuTan = linePassengerFlowByScenic.getCaoYuTan();
        String nullListJson = "[]";
        String pic4Options = PIC4;
        if(CollectionUtil.isNotEmpty(hongYaXian)){
            pic4Options = pic4Options.replace("lineNameArray",JsonUtils.toJsonString(hongYaXian.stream().map(e -> e.getName()).collect(Collectors.toList())))
            .replace("hongYaXian",JsonUtils.toJsonString(hongYaXian.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("lineNameArray",nullListJson);
        }
        if(CollectionUtil.isNotEmpty(zhuChengQu)){
            pic4Options = pic4Options.replace("zhuChengQu",JsonUtils.toJsonString(zhuChengQu.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("zhuChengQu",nullListJson);
        }
        if(CollectionUtil.isNotEmpty(liuJiangGuZhen)){
            pic4Options = pic4Options.replace("liuJiangGuZhen",JsonUtils.toJsonString(liuJiangGuZhen.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("liuJiangGuZhen",nullListJson);
        }
        if(CollectionUtil.isNotEmpty(qiLiPing)){
            pic4Options = pic4Options.replace("qiLiPing",JsonUtils.toJsonString(qiLiPing.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }
        if(CollectionUtil.isNotEmpty(waWuShan)){
            pic4Options = pic4Options.replace("waWuShan",JsonUtils.toJsonString(waWuShan.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("waWuShan",nullListJson);
        }
        if(CollectionUtil.isNotEmpty(yuPingShan)){
            pic4Options = pic4Options.replace("yuPingShan",JsonUtils.toJsonString(yuPingShan.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("yuPingShan",nullListJson);
        }
        if(CollectionUtil.isNotEmpty(caoYuTan)){
            pic4Options = pic4Options.replace("caoYuTan",JsonUtils.toJsonString(caoYuTan.stream().map(e -> e.getValue()).collect(Collectors.toList())));
        }else{
            pic4Options = pic4Options.replace("caoYuTan",nullListJson);
        }

        // 行业消费
        SpecialReportWordData.TourismConsumptionAnalysis tca = data.getTCA();
        List<TourismConsumptionIndustryAnalyzeVO> pieBusinessConsumption = tca.getIndustryData();
        List<SpecialReportWordData.CommonNameValue> pieBusinessConsumptionList = pieBusinessConsumption.stream().map(e -> new SpecialReportWordData.CommonNameValue(e.getIndustry(), e.getTransAt().toString())).collect(Collectors.toList());
        List<String> tcaPieNameList = pieBusinessConsumptionList.stream().map(e -> e.getName()).collect(Collectors.toList());
        Collections.reverse(pieBusinessConsumptionList);
        String pic5Options = PIC5.replace("pieNameArray",JsonUtils.toJsonString(tcaPieNameList))
                .replace("pieValueArray",JsonUtils.toJsonString(pieBusinessConsumptionList));

        // 游客消费来源地
        TourismConsumptionSourceAnalyzeVO sourceData = tca.getSourceData();
        List<String> pieSourceNameList = Arrays.asList("省内","省外");
        List<SpecialReportWordData.CommonNameValue> pieSourceList = Arrays.asList(
          new SpecialReportWordData.CommonNameValue("省内",sourceData.getInnerProvTransAt().toString()),
          new SpecialReportWordData.CommonNameValue("省外",sourceData.getOuterProvTransAt().toString())
        );
        String pic6Options = PIC6.replace("pieNameArray",JsonUtils.toJsonString(pieSourceNameList))
                .replace("pieValueArray",JsonUtils.toJsonString(pieSourceList));

        // 省内游客消费柱状图
        List<TourismConsumptionSourceAnalyzeVO.TransInfo> innerProvList = sourceData.getInnerProvList();
        List<String> barInnerProvNameList = innerProvList.stream().map(e->e.getSource()).collect(Collectors.toList());
        BigDecimal wan = new BigDecimal("10000");
        List<String> barInnerProvValueList = innerProvList.stream().map(e -> e.getTransAt().divide(wan,2,BigDecimal.ROUND_HALF_UP).toString()).collect(Collectors.toList());
        Collections.reverse(barInnerProvNameList);
        Collections.reverse(barInnerProvValueList);
        String pic7Options = PIC7.replace("barNameArray",JsonUtils.toJsonString(barInnerProvNameList))
                .replace("barValueArray",JsonUtils.toJsonString(barInnerProvValueList));

        // 省外游客消费柱状图
        List<TourismConsumptionSourceAnalyzeVO.TransInfo> outerProvList = sourceData.getOuterProvList();
        List<String> barOuterProvNameList = innerProvList.stream().map(e->e.getSource()).collect(Collectors.toList());
        List<String> barOuterProvValueList = innerProvList.stream().map(e -> e.getTransAt().divide(wan,2,BigDecimal.ROUND_HALF_UP).toString()).collect(Collectors.toList());
        Collections.reverse(barOuterProvNameList);
        Collections.reverse(barOuterProvValueList);
        String pic8Options = PIC8.replace("barNameArray",JsonUtils.toJsonString(barOuterProvNameList))
                .replace("barValueArray",JsonUtils.toJsonString(barOuterProvValueList));

        // 车流趋势图
        SpecialReportWordData.TrafficAnalysis ta = data.getTA();
        List<StringLongVO> lineTrafficFlowTrend = ta.getLineTrafficFlowTrend();
        List<String> lineTrendNameList = lineTrafficFlowTrend.stream().map(e->e.getName()).collect(Collectors.toList());
        List<Long> lineTrendValueList = lineTrafficFlowTrend.stream().map(e->e.getValue()).collect(Collectors.toList());
        String pic9Options = PIC9.replace("lineNameArray",JsonUtils.toJsonString(lineTrendNameList))
                .replace("lineValueArray",JsonUtils.toJsonString(lineTrendValueList));

        // 酒店累计接待折线图
        SpecialReportWordData.HotelAnalysis hca = data.getHCA();
        List<KeyAndValue<String, Integer>> lineCheckInAmount = hca.getLineCheckInAmount();
        List<String> lineKeyList = lineCheckInAmount.stream().map(e->e.getKey()).collect(Collectors.toList());
        List<Integer> lineValueList = lineCheckInAmount.stream().map(e->e.getValue()).collect(Collectors.toList());
        String pic10Options = PIC10.replace("lineNameArray",JsonUtils.toJsonString(lineKeyList))
                .replace("lineValueArray",JsonUtils.toJsonString(lineValueList));

        // 酒店入住年龄分布图
        List<KeyAndValue<String, Integer>> barCheckInAgeDistribution = hca.getBarCheckInAgeDistribution();
        List<String> barNameList = barCheckInAgeDistribution.stream().map(e->e.getKey()).collect(Collectors.toList());
        List<Integer> barValueList = barCheckInAgeDistribution.stream().map(e->e.getValue()).collect(Collectors.toList());
        String pic11Options = PIC11.replace("barNameArray",JsonUtils.toJsonString(barNameList))
                .replace("barValueArray",JsonUtils.toJsonString(barValueList));

        // 酒店入住过夜数占比饼图
        List<KeyAndValue<String, Integer>> pieDataStayOvernight = hca.getPieDataStayOvernight();
        List<SpecialReportWordData.CommonNameValue> pieDataStayOvernightList = pieDataStayOvernight.stream().map(e -> new SpecialReportWordData.CommonNameValue(e.getKey(), e.getValue().toString())).collect(Collectors.toList());
        List<String> pieDataStayOvernightNameList = pieDataStayOvernight.stream().map(e -> e.getKey()).collect(Collectors.toList());
        String pic12Options = PIC12.replace("pieNameArray",JsonUtils.toJsonString(pieDataStayOvernightNameList))
                .replace("pieValueArray",JsonUtils.toJsonString(pieDataStayOvernightList));

        /**
         * 清空工作目录
         */
        FileUtil.del(TEMP_DIR + File.separator + "temp");
        Map<String, Object> datas = new HashMap(32);
        //主标题
        datas.put("data",data);
        datas.put("pic1", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic1Options))));
        datas.put("pic2", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic2Options))));
        datas.put("pic3", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic3Options))));
        datas.put("pic4", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic4Options))));
        datas.put("pic5", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic5Options))));
        datas.put("pic6", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic6Options))));
        datas.put("pic7", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic7Options))));
        datas.put("pic8", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic8Options))));
        datas.put("pic9", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic9Options))));
        datas.put("pic10", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic10Options))));
        datas.put("pic11", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic11Options))));
        datas.put("pic12", Base64.encode(new File(generate(TEMP_DIR,TEMP_DIR,pic12Options))));
        WordGeneratorUtils.createDoc(WordGeneratorUtils.DATA_CENTER_REPORT,TEMP_DIR + File.separator +"大数据中心报告.doc",datas);
    }

    /**
     * 生成echarts图片
     * @param tempDir
     * @param options
     * @return
     */
    public static String generate(String binDir,String tempDir,String options) {
        String dataPath = writeFile(tempDir,options);
        String fileName= System.currentTimeMillis() + ".png";
        String path = tempDir + File.separator + "temp" + File.separator + fileName;
        try {
            File file = new File(path);
            if (!file.exists()) {
                File dir = new File(file.getParent());
                dir.mkdirs();
                file.createNewFile();
            }
            //生成命令行
            String phantomjsPath = isLinux()?"phantomjs ":tempDir + File.separator + "phantomjs.exe " ;
            String jsPath = binDir + File.separator + "echarts-convert.js ";
            String cmd = phantomjsPath + " "+ jsPath + " -infile " + dataPath + " -outfile " + path;
//            String cmd = "D:\\temp\\phantomjs.exe D:\\temp\\echarts-convert.js -infile D:\\temp\\1588841603389.json -outfile D:\\temp\\1.png";
            Process process = Runtime.getRuntime().exec(cmd);
            try (BufferedReader input = new BufferedReader(new InputStreamReader(process.getInputStream()))) {
                String line = "";
                while ((line = input.readLine()) != null) {
                   log.info(line);
                }
            }
        } catch (IOException e) {
           log.error("phantomjs命令执行错误");
        }
        return path;
    }

    /**
     * 生成JSON数据文件
     * @param tempDir
     * @param options
     * @return
     */
    private static String writeFile(String tempDir,String options) {
        String dataPath = tempDir + File.separator + "temp" + File.separator + System.currentTimeMillis() +".json";
        try {
            File writeName = new File(dataPath);
            if (!writeName.exists()) {
                File dir = new File(writeName.getParent());
                dir.mkdirs();
                writeName.createNewFile();
            }
            try (BufferedWriter out = new BufferedWriter(new FileWriter(writeName))) {
                out.write(options);
                out.flush();
            }
        } catch (IOException e) {
            log.error("生成echarts的options数据文件出错");
        }
        return dataPath;
    }

    /**
     *  简单判断系统类型
     * @return 是否Linux操作系统
     *
     */
    public static boolean isLinux() {
        return !System.getProperty("os.name").toLowerCase()
                .startsWith("windows");
    }
}